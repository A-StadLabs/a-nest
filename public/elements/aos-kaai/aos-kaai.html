<link rel="import" href="../../bower_components/polymer/polymer.html">
<link rel="import" href="../../bower_components/core-toolbar/core-toolbar.html">
<link rel="import" href="../../bower_components/core-icon-button/core-icon-button.html">
<link rel="import" href="../../bower_components/core-dropdown/core-dropdown.html">
<link rel="import" href="../../bower_components/core-input/core-input.html">
<link rel="import" href="../../bower_components/core-field/core-field.html">
<link rel="import" href="../../bower_components/flag-icon/flag-icon.html">
<link rel="import" href="../../bower_components/core-menu/core-menu.html">
<link rel="import" href="../../bower_components/core-dropdown/core-dropdown.html">
<link rel="import" href="../../bower_components/core-selector/core-selector.html">
<link rel="import" href="../../bower_components/core-item/core-item.html">
<link rel="import" href="../../bower_components/core-menu-button/core-menu-button.html">
<link rel="import" href="../../bower_components/core-icon-button/core-icon-button.html">
<link rel="import" href="../../bower_components/core-dropdown-menu/core-dropdown-menu.html">
<link rel="import" href="../../bower_components/core-header-panel/core-header-panel.html">
<link rel="import" href="../../bower_components/core-scroll-header-panel/core-scroll-header-panel.html">


<!-- <link rel="import" href="../../bower_components/notification-elements/src/notification-elements.html"> -->
<link href='//fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800|Open+Sans+Condensed:300italic,700,300' rel='stylesheet' type='text/css'>

<polymer-element name="aos-kaai" attributes="environment theme language notification user">

  <template>


    <link rel="stylesheet" href="aos-kaai-dark.css" />

    <aos-globals id="globals"></aos-globals>
   <template if="{{!$.globals.values.user}}">

    <core-toolbar horizontal center center-justified layout fit class="{{ {gefocused: searchFocused } | tokenList}}">


      <div class="helpings" horizontal layout >

 <core-dropdown-menu label="Taal" class="lan">
          <core-dropdown class="dropdown">
            <core-selector selected="0" id="lanselect" valueattr="label">
              <core-item label="NL"></core-item>
              <core-item label="FR"></core-item>
              <core-item label="EN"></core-item>
              <core-item label="DE"></core-item>
            </core-selector>
          </core-dropdown>
        </core-dropdown-menu>

        <a href="/help" class="helpbtn" ><core-icon-button label="help" id="bthelp" src="images/kaai-help.svg">
        </core-icon-button></a>

</div>

      <div class="tools" horizontal center end-justified layout>

        <a href="/#/profiel"><core-icon-button  class="kaaibtns" label="profiel" id="btsearch" src="images/kaai-searchloop.svg">
        </core-icon-button></a>

        <a href="/#/knooppunt"><core-icon-button class="kaaibtns" label="knooppunt" id="btdock" src="images/kaai-knooppunt.svg">
        </core-icon-button></a>
        
        <a href="/#/profiel "><core-icon-button class="kaaibtns" label="profiel" id="btaccount" src="images/kaai-profiel2.svg">
        </core-icon-but
        ton></a>
      </div>
      <core-ajax method="GET" id="loginAjax" handleAs="json" url="/login" response="{{responseUser}}" on-core-response="{{handleResponseUser}}" auto>
    </core-toolbar>
    </template>

    <template if="{{$.globals.values.user}}">

    <core-toolbar horizontal center center-justified layout fit class="{{ {gefocused: searchFocused } | tokenList}}">


      <div class="helpings" horizontal layout >

 <core-dropdown-menu label="Taal" class="lan">
          <core-dropdown class="dropdown">
            <core-selector selected="0" id="lanselect" valueattr="label">
              <core-item label="NL"></core-item>
              <core-item label="FR"></core-item>
              <core-item label="EN"></core-item>
              <core-item label="DE"></core-item>
            </core-selector>
          </core-dropdown>
        </core-dropdown-menu>

        <a href="/help" class="helpbtn" ><core-icon-button label="help" id="bthelp" src="images/kaai-help.svg">
        </core-icon-button></a>

</div>



      <div class="tools" horizontal center end-justified layout>

        <a href="/#/profiel"><core-icon-button  class="kaaibtns" label="profiel" id="btsearch" src="images/kaai-searchloop.svg">
        </core-icon-button></a>

        <a href="/#/knooppunt"><core-icon-button class="kaaibtns" label="knooppunt" id="btdock" src="images/kaai-knooppunt.svg">
        </core-icon-button></a>

        <a href="/#/notificaties"><core-icon-button class="kaaibtns" label="notificaties" id="btnot" src="images/kaai-knooppunt.svg">
        </core-icon-button></a>
    
        <a href="/#/profiel "><img src="{{$.globals.values.user.data.avatarUrl}}" class="avatar"></a>
      </div>
    </core-toolbar>
    </template>

  </template>

  <script>

    // function getParameterByName(name) {
    //   name = name.replace(/[\[]/, "\\[").replace(/[\]]/, "\\]");
    //   var regex = new RegExp("[\\?&]" + name + "=([^&#]*)"),
    //   results = regex.exec(location.search);
    //   return results === null ? "" : decodeURIComponent(results[1].replace(/\+/g, " "));
    // }

    // var userobject;

    Polymer({

      ready: function() {

        //         this.searchFocused = false;

        // this.bigSearchbar = false;
        // this.smallSearchbar = true;

        // if(window.innerWidth < 401){
        //   this.bigSearchbar = true;
        //   this.smallSearchbar = false;
        // };


        // var tokenn = getParameterByName('access_token');
        // if(tokenn){
        //   console.log('hey! ',tokenn);

        // };

        // Localisation voorlopig
        this.locusername = 'Gebruikersnaam';
        this.locsearch = 'Zoeken';
        this.locpassword = 'Wachtwoord';
        this.locaanmelden = 'Aanmelden met A-profiel';
        this.locaanmeldcta = 'Aanmelden';
        this.locforgot = 'Ik ben mijn gegevens vergeten';
        this.locregister = 'Ik heb nog geen A-profiel';
        this.locsearchresult = 'Zoekresultaten voor';
        //this.$.notif.notify();
        this.$.lanselect.addEventListener('core-activate', function(e){
          console.log(e.detail.item.label);
          this.language = e.detail.item.label;
        });

        // this.$.envselect.addEventListener('core-activate', function(e){
        //   console.log(e.detail.item.label);
        //   this.environment = e.detail.item.label;
        //   switch(this.environment){
        //     case 'Antwerpen.be':
        //       var loc = "https://www.antwerpen.be";
        //       break;
        //     case 'Wilrijk.be':
        //       var loc = "https://www.wilrijk.be";
        //       break;
        //     case 'Visit Antwerpen':
        //       var loc = "http://www.visitantwerpen.be/bzn.net?id=1464";
        //       break;
        //     case 'Ondernemen':
        //       var loc = "http://www.ondernemeninantwerpen.be";
        //       break;
        //     case 'Oostende':
        //       var loc = "http://www.oostende.be/";
        //       break;
        //     case 'Stedelijk Onderwijs':
        //       var loc = "http://www.stedelijkonderwijs.be/";
        //       break;


              

                   

        //   }
          
        //   document.getElementById('canvas').src = loc;
        // });

      },

      openAuth: function(){
        //if(!userobject){
          window.open("https://services.antwerpen.be/authorize?scope=default&response_type=token&client_id=_07mr9GBEvhvd_iG0Jd1rbSWfW4a&redirect_uri=http%3A%2F%2Flocalhost%3A9000%2F%23%2Flogin%2F", "myWindow", "scrollbars=yes, resizable=yes, width=400, height=570");
       // } else {
        //  this.loginPane = !this.loginPane;
        //}
      },

      handleFocus: function(){
        this.searchFocused = true;
        console.log(this.searchFocused);
        location.href('/search');
      },

      handleBlur: function(){
        this.searchFocused = false;
        console.log(this.searchFocused);
      },

      notificationChanged: function(){
        this.$.notif.notify();
      },

      closeAll: function(){
        //this.$.toolsmenu.selected = -1;
      },

      toggleLogin: function(){
        this.closeAll();
        this.loginPane = !this.loginPane;
      },

      toggleLang: function(){
        this.closeAll();
        this.locPane = !this.locPane;
      },

      toggleSearch: function(){
        this.closeAll();
        this.searchPane = !this.searchPane;
      },

      handleResponseUser: function(){
        this.user = this.userresult;
        console.log(this.userresult);
      },

      selectAction: function(e, detail) {
        if (detail.isSelected) {
          var selectedItem = detail.item;
          console.log(selectedItem);
        }
      }

    });


 

  </script>


</polymer-element>
