<link rel="import" href="../../../../bower_components/polymer/polymer.html">
<link rel="import" href="../time-ago/src/time-ago.html">
<script src="//cdnjs.cloudflare.com/ajax/libs/moment.js/2.8.3/moment-with-locales.min.js"></script>
<link rel="import" href="../cl-voteitem/cl-voteitem.html">
<link rel="import" href="../babbel-antwoord/babbel-antwoord.html">
<link rel="import" href="../babbel-postcomment/babbel-postcomment.html">

<polymer-element name="babbel-babbel" attributes="childOf key object mode">

  <template>
    <link rel="stylesheet" href="babbel-babbel.css" />

    <template if="{{mode=='parent'}}">

    <div class="convitem" horizontal layout start start-justified>
      <div class="updownbtns" vertical layout center>
        <cl-voteitem key="{{k}}" votes="{{object.votes}}"></cl-voteitem>
      </div>
      <div class="convcontent" vertical layout start on-tap="{{fireSelect}}">
      <h1 on-tap="{{gotoDetail}}" key="{{key}}" name="convSelected">{{object.title}}</h1>
        <small>
          <time-ago datetime="{{object.time}}"></time-ago> | 
          <span class="convcomments"> 112 reacties </span>
        </small>
      </div>
      </div>

      </template>

      <template if="{{mode=='child'}}">

      <div class="convitem" horizontal layout start start-justified>
      <div class="updownbtns" vertical layout center>
        <cl-voteitem key="{{k}}" votes="{{object.votes}}"></cl-voteitem>
      </div>
      <div class="convcontent" vertical layout start on-tap="{{fireSelect}}">
      <h1 on-tap="{{gotoDetail}}" key="{{key}}" name="convSelected">KIND {{object.title}}</h1>
        <small>
          <time-ago datetime="{{object.time}}"></time-ago> | 
          <span class="convcomments"> 112 reacties </span>
        </small>
      </div>
      </div>

      </template>
    
  </template>

  <script>

    

    Polymer({

      ready: function(){
        this.childdata = [];
      },

      childdataChanged: function(){
        console.log('yooow:', this.childdata);
      },

      childOfChanged: function() {
        var that = this;
          console.log(opdata, ' vanuit element');
            for (var i = opdata.length - 1; i >= 0; i--) {
              console.log('my mom is: ', opdata[i].mother);
              console.log('my key is: ', that.key);
              if(opdata[i].mother==that.key){
                this.childdata.push({ 
                  'key': opdata[i].key,
                  'title': opdata[i].title, 
                  'tags': opdata[i].tags, 
                  'votes': opdata[i].votes,
                  'op': opdata[i].op,
                  'mother': opdata[i].mother,
                  'time': opdata[i].time
                });
                console.log('children: ',this.childdata);
            };

          }
        },

      fireSelect: function(){
        this.fire('babbel-select', {key: this.key, data: this.object})
      }

      


    });

  </script>

</polymer-element>
