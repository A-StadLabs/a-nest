<link rel="import" href="../../bower_components/polymer/polymer.html">
<link rel="import" href="elements.html">

<polymer-element name="aos-babbles" attributes="key sort">
<template>
  <link rel="stylesheet" href="aos-babbles.css" />
  <div class="leaderboard">
    <img class="stralendeA" src="images/astadlabs.svg">
    <div horizontal layout wrap center start-justified>
      <div horizontal layout wrap center start-justified flex>
        <img class="appicon" src="images/babbelbox.svg">
        <h1>Babbles</h1><input type="text" on-keyup="{{filter}}" class="searchbox">
      </div>
    </div>
  </div>
  <aos-globals id="globals"></aos-globals>
  <ba-user bauser="{{bauser}}"></ba-user>
  <ba-data key="{{key}}" response="{{messages}}" headline="{{head}}"></ba-data>

  <core-overlay id="sharelink" layered backdrop>
    <input value="{{sharelinkurl}}" onFocus="this.select();" />
  </core-overlay>

  <div class="canvas">
    
    <template if="{{key!='home'}}">
    <babbel-babbel key="{{head.key}}" data="{{head.data}}" id="parent"></babbel-babbel>
    </template>
    <template if="{{$.globals.values.user}}">  
      <ba-poster path="{{key}}" mode="parent" role="user"></ba-poster>
    </template>
    <template if="{{!$.globals.values.user}}">  
      <div id="roledefinition">
        <small><a is="pushstate-anchor" href="/profiel"><b>Meld je aan</b></a> om een onderwerp te starten of om te reageren.</small>
      </div>
    </template>

    <!-- Sorteer dingen -->
    <div id="generalsort" horizontal layout center start-justified wrap>
      <p>Sorteer op</p>
      <core-selector valueattr="sort" selected="{{sort}}" id="sorting">
        <button class="sortbtn" active?="{{sort==this.sort}}" sort="votes">Meeste votes</button>
        <button class="sortbtn" active?="{{sort==this.sort}}" sort="time">Meest recent gepost</button>
        <button class="sortbtn" active?="{{sort==this.sort}}" sort="numchildren">Meeste antwoorden</button>
        <button class="sortbtn" active?="{{sorter==this.sort}}" sort="lastpost">Meest recent beantwoord</button>
      </core-selector>
    </div>

    <!-- De lijst -->
    <template repeat="{{k in messages | orderBy(sort, true) }}">
      <babbel-babbel key="{{k.key}}" data="{{k}}" mode="parent" sort="{{sort}}"></babbel-babbel>
      <hr>
    </template>
  </div>
</template>

<script>
  Polymer({

    ready: function() {
      console.log('\r\r\n\naos: Babbles loaded.\n\n\r\r');
     

    }
  });
</script>
</polymer-element>
