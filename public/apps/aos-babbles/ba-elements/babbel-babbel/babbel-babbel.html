<link rel="import" href="../../../../bower_components/polymer/polymer.html">
<link rel="import" href="../../../../elements/aos-globals/aos-globals.html">

<link rel="import" href="../cl-voteitem/cl-voteitem.html">
<link rel="import" href="../ba-getpermissions/ba-getpermissions.html">
<link rel="import" href="../time-ago/src/time-ago.html">

<polymer-element name="babbel-babbel" attributes="key data mode parent kids sort">

<template>

  <link rel="stylesheet" href="babbel-babbel.css" />

  <aos-globals id="globals" values="{{globs}}"></aos-globals>

  <!-- <firebase-element id="bericht" location="https://blazing-fire-6426.firebaseio.com/babbles/messages/{{key}}/" data="{{data}}" keys="{{keys}}" on-data-change="{{handleResponse}}"></firebase-element> -->

  <ba-getpermissions role="{{data.role}}" usercanpost="{{usercanpost}}"></ba-getpermissions>

  <div horizontal layout start>
    <template if="{{usercanpost}}">
      <cl-voteitem key="{{key}}" votes="{{data.votes}}" mode="{{mode}}"></cl-voteitem>
    </template>
    <template if="{{!usercanpost}}">
      <div class="voterij"><p>{{data.votes}}</p></div>
    </template>
    <div vertical layout start>
      <h2><a is="pushstate-anchor" href="#/babbles/{{key}}/?sort={{sort}}">{{data.text}}</a></h2>
      <ba-getpermissions role="{{data.role}}" usercanpost="{{usercanpost}}"></ba-getpermissions>
      <p>
        <img src="../../images/share3.svg" class="share" on-tap="{{sharelink}}">
        <template if="{{data.time}}"><time-ago datetime="{{data.time}}" refresh delay="1000"></time-ago></template>
         - {{data.numchildren}} reacties - Laatste reactie: 
         <template if="{{data.lastpost}}"><time-ago datetime="{{data.lastpost}}" refresh delay="1000"></time-ago></template>
          - 
        <template if="{{!usercanpost}}">
          <img class="lock" src="../../images/locked.svg">Enkel {{data.role}} kan reageren.
        </template>
        <template if="{{usercanpost}}">
          Jij kan reageren.
        </template> 
      </p>
    </div>
  </div>

</template>

<script>

  Polymer({

      ready: function(){
        //this.parent = this.object.parent;
      }

    });

</script>

</polymer-element>
