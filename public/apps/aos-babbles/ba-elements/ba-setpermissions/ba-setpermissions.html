<link rel="import" href="../../../../bower_components/polymer/polymer.html">
<link rel="import" href="../../../../bower_components/core-selector/core-selector.html">
<link rel="import" href="../../../../bower_components/core-ajax/core-ajax.html">
<link rel="import" href="../../../../elements/aos-globals/aos-globals.html">

<polymer-element name="ba-setpermissions" attributes="">
  <template>
    <link rel="stylesheet" href="ba-setpermissions.css" />

      	<aos-globals id="globals" values="{{globs}}"></aos-globals>

    <div vertical layout>

    <h3>Wie mag antwoorden?{{roleselected}}</h3>
    <div>
    	<core-selector selected="{{roleselected}}" valueattr="role">
    		<template repeat="{{r in globs.user.data.roles}}">
    			<div role="{{r}}">{{r}}</div>
    		</template>
    	</core-selector>
    </div>

    	<core-ajax id="findstreet" on-core-response="{{streetresp}}" response="{{streetresponse}}"></core-ajax>
    
    <div horizontal layout center start-justified><p>District: </p><input id="district" value="" /></div>
    <div horizontal layout center start-justified><p>Straat: <input id="straat" value="{{streetvalue}}" /></div>
    <div><p>Huisnummer van: <input class="shortinput" id="numfrom" value="{{numfrom}}" />
    	tot: <input class="shortinput" id="numto" value="{{numto}}" /></div>
    <h6>{{selstreet}}</h6>
    <div>
    	<template repeat="{{s, i in streets}}">
    		<core-selector valueattr="key" selected="{{streetvalue}}">
    			<p key="{{streets[i].street}}">{{streets[i].street}} - {{streets[i].district}}</p>
    		</core-selector>
    	</template>
    </div>
    	<h4>Persoon</h4>
        <button class="closebtn" on-tap="{{closeThis}}">Bevestigen</button>
    </div>

   
</template>
<script>
    Polymer({
    	ready: function(){
    		var that = this;
    		this.$.straat.addEventListener('keypress', function(e) {
    			var ajax = that.$.findstreet;
    			console.log('value: ', that.streetvalue);
	    		if (e.keyCode == 13) {
	      			
	        		//that.enter();
	        		//ajax.go();
	      			
	    		};
	    		ajax.go();
	    		that.$.findstreet.url = "/adres?search="+that.streetvalue;
	    		
	  		});
    	},

    	streetresp: function(){
    		console.log('got response', JSON.parse(this.streetresponse));
    		this.streets = JSON.parse(this.streetresponse);
    		console.log(JSON.stringify(this.streets.data));
    		this.streets = this.streets.data;

    	},

        closeThis: function(){
            this.fire('closethisthing');
        }
    });
</script>
</polymer-element>