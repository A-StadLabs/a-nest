<link rel="import" href="../../bower_components/polymer/polymer.html">
<link rel="import" href="../../elements/aos-globals/aos-globals.html">
<link rel="import" href="../../bower_components/paper-input/paper-input.html">
<link rel="import" href="../../bower_components/paper-button/paper-button.html">
<link rel="import" href="../../bower_components/core-ajax/core-ajax.html">

<polymer-element name="aos-smslogin" attributes="">

  <template>

    <link rel="stylesheet" href="aos-smslogin.css" />
    <core-ajax method="GET" id="checkUser" handleAs="json" url="/user" response="{{responseCheck}}" on-core-response="{{handleResponseCheck}}" auto></core-ajax>

    <core-ajax method="GET" id="userCheck" handleAs="json" url="/usercheck" response="{{responseUser}}" on-core-response="{{handleResponseUserCheck}}"></core-ajax>

    <core-ajax method="GET" id="codeCheck" handleAs="json" url="/codecheck" response="{{responseCode}}" on-core-response="{{handleResponseCodeCheck}}"></core-ajax>

    <paper-button on-tap="{{recheckUser}}">N</paper-button>
    <h2>Aanmelden / Registreren</h2>
    <h3>{{responseCheck}}</h3>
      <div>
        <paper-input label="Jouw gsm nummer" id="input2" is="core-input" value="{{inputvalue}}" pattern="^[0-9].*"></paper-input>
      </div>
      <div>
        <paper-button raised on-tap="{{validate}}">Verzenden</paper-button>
      </div>

    <h2>Verifieer code</h2>
    <div>
        <paper-input label="Code" id="code" is="core-input" value="{{codevalue}}"></paper-input>
      </div>
      <div>
        <paper-button raised on-tap="{{checkcode}}">Verzenden</paper-button>
      </div>
  </template>

  <script>

    Polymer({

      ready: function() {

      	console.log('Knooppunt app loaded.'); 

      },

      validate: function() {
        console.log(this.inputvalue);
        var gsmnummer = this.inputvalue;
        this.$.userCheck.params = { "gsm": gsmnummer };
        //this.$.loginAjax.params = { "username": "kingflurkel", "password": "mike48" };
        this.$.userCheck.go();
      },

      handleResponseUserCheck: function(){
        console.log(this.responseUser.code);
        this.kode = this.responseUser.code;
      },

      handleResponseCheck: function(){
        console.log(this.responseCheck);
      },

      checkcode: function(){
        var code = this.codevalue;
        var gsm = this.inputvalue;
        this.$.codeCheck.params = { "kode": code, "gsm": gsm };
        this.$.codeCheck.go();
      },

      handleResponseCodeCheck: function(){
        console.log(this.responseCode);
      },

      recheckUser: function(){
        this.$.checkUser.go();
      }



    });

  </script>

</polymer-element>
