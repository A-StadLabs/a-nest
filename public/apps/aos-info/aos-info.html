<link rel="import" href="../../bower_components/polymer/polymer.html">
<link rel="import" href="../../bower_components/firebase-element/firebase-element.html">
<link rel="import" href="../../bower_components/core-overlay/core-overlay.html">
<link rel="import" href="../../bower_components/core-animated-pages/core-animated-pages.html">
<link rel="import" href="../../bower_components/core-selector/core-selector.html">
<link rel="import" href="../../bower_components/core-ajax/core-ajax.html">

<link rel="import" href="../../bower_components/core-animated-pages/transitions/slide-from-right.html">
<link rel="import" href="elements/aos-addinfocat/aos-addinfocat.html">
<link rel="import" href="elements/aos-addinfosub/aos-addinfosub.html">
<link rel="import" href="elements/aos-cat/aos-cat.html">
<link rel="import" href="elements/aos-infoleftmenu/aos-infoleftmenu.html"> 


<link rel="import" href="../../elements/aos-artikel/aos-artikel.html"> 

<polymer-element name="aos-info" attributes="lorem">

  <template>

    <link rel="stylesheet" href="aos-info.css" />

    
  <div class="leaderboard">
    <img class="stralendeA" src="../../elements/aos-homebabbelbox/images/a-rgb.svg">
    <div horizontal layout wrap center start-justified>
        <img class="appicon" src="images/infocenter.svg">
        <h1>Info Center</h1><input type="text" on-keyup="{{filter}}" class="searchbox">
       
        <firebase-element location="https://blazing-fire-6426.firebaseio.com/infocenter" orderByChild="categorie" data="{{data}}" keys="{{keys}}" on-data-change="{{handleResponse}}"></firebase-element>

    </div>
  </div>


<core-animated-pages id="scenes" transitions="slide-from-right">
<section>
  <div class="container">
    <div id="canvas" >

        <div horizontal layout start wrap>
        <template repeat="{{k in keys}}">
        <aos-cat titel="{{data[k].categorie}}" shorttxt="{{data[k].shorttxt}}" key="{{k}}"></aos-cat>
        </template>

        
        </div>
        <template bind>
        <div vertical layout center class="addbtn" on-tap="{{openAddCat}}"><h4>Een categorie toevoegen</h4></div>
        <core-overlay layered backdrop id="overlay">
          <aos-addinfocat></aos-addinfocat>
        </core-overlay>
        </template>
        
    </div>
  </div>

</section>
<section>
  <div class="container">
    <div id="canvas">
      <aos-infoleftmenu selectedCat="{{selectedCat}}" selectedTitle="{{selectedTitle}}"></aos-infoleftmenu>
    </div>
  </div>
</section>

<section>
<core-ajax url="https://www.antwerpen.be/srv/content/d/detail/id/537ca18cb0a8a70b5c8b458c" handleAs="json" response="{{artikel}}" on-core-response="{{handleResponseArtikel}}" auto method="GET"></core-ajax>
<core-ajax url="/searching" id="searchInfo" handleAs="json" response="{{searchresult}}" on-core-response="{{handleResponseSearch}}" method="POST"></core-ajax>

  <div class="container">
    <div id="canvas">
    <input type="text" on-keyup="{{searchBox}}" class="searchbox">
      <small on-tap="">< {{selectedCat}}</small>
      <div class="column">
      <aos-artikel mode="long" object="{{artikel.data}}"></aos-artikel>

    </div>
    </div>
  </div>
</section>

</core-animated-pages>


  </template>

  <script>

    Polymer({

      handleResponseArtikel: function(){
        console.log('artikel: ', JSON.stringify(this.artikel));
      },


      ready: function() {
        this.$.scenes.selected = 0;

      	console.log('info app loaded.'); 

        this.addEventListener('menureset', function(){
          this.$.scenes.selected = 0;

          });

        this.addEventListener('detail-tapped', function(e){
          console.log('detail tapped: ', e.detail.key);
          this.$.scenes.selected = 1;
          this.selectedCat = e.detail.key;
          this.selectedTitle = e.detail.cat;
        })

      },

      response: function(){
        console.log('ajax response', this.localjson);
      },

      openAddCat: function(){
        this.$.overlay.toggle();
        console.log('ajax response', this.localjson);
      },
      
      cattapped: function(){
        console.log(this.$.catselector.selected);
      },

      handleResponse: function(){
        
      },

      searchBox: function(e, detail, sender){
        console.log(sender.value);
        // this.zoekOpdracht = { "type": [{"key":9,"value":"Infofiche","type":"type"}],
        //                       "titel":[{"key":"titel","value":"aanvraag","type":"titel"}]
        //                     };

        //this.$.searchInfo.headers = {"Content-Type": "application/json"};
        this.$.searchInfo.body = {search:sender.value};
        this.$.searchInfo.go();
      }

      // filter: function(e, detail, sender) {
      //   console.log('there it is', this.lorem);
      //   var regex = new RegExp(sender.value, 'i');
      //   this.filteredData = this.lorem.filter(function(d, idx, array) {
      //     return regex.test(data[k]);
      //   });
      // }

      


    });

  </script>

</polymer-element>
