<link rel="import" href="../../../../bower_components/polymer/polymer.html">
<link rel="import" href="../../../../bower_components/core-animated-pages/transitions/slide-from-right.html">
<link rel="import" href="../../../../bower_components/core-animated-pages/core-animated-pages.html">
<link rel="import" href="../../../../bower_components/core-ajax/core-ajax.html">

<polymer-element name="aos-infoleftmenu" attributes="selectedCat selectedTitle subCat subKey details">
  <template>
    <link rel="stylesheet" href="aos-infoleftmenu.css">
      <div id="leftmenu">
        
              <small on-tap="{{toNext}}"> naar overzicht</small>

              <core-ajax 
        url="/infofichetabs?slug={{subCat}}"
        method="GET" 
        auto 
        handleAs="json" 
        response="{{tabs}}"
        on-core-response="{{handleResponse}}">
        </core-ajax>

        <h2>{{selectedTitle}}</h2>
      </div> 
      <div id="leftmenu2">
        <core-animated-pages id="subcatscenes" transitions="slide-from-right">
        <section>
        <core-selector id="catselector" selected="{{selected}}" valueattr="label" on-core-activate="{{cattapped}}">
        <template repeat="{{t in tabs.data.links}}">
          <div label="{{t.title}}" key="{{t.slug}}" class="subcats" details="{{t.details}}">{{t.title}}</div>
        </template>
        </core-selector>
          
        </section>

        <section>
          <div id="subcat" horizontal layout center> <img id="bckbtn" on-tap="{{toCatMenu}}" src="../../images/back.svg">{{subCat}}
          </div>



      <!-- <div id="subcatdetail" hidden?="{{windowMobile}}">
      <template repeat="{{t in tabs.data.links}}">
          <div label="{{subdata[sk].subtitel}}" key="{{sk}}" class="subcats">{{t.title}}</div>
        </template>




      </div> -->

        </section>
      </core-animated-pages>

      </div> 

  </template>
  <script>
    (function () {
      'use strict';

      var subKey = '';

      Polymer({
        // define element prototype here
        ready: function(){

          var that = this;

          this.subKey = subKey;
          this.$.catselector.addEventListener('core-activate', function(e){
            that.subCat = this.selected;
            that.subKey = e.detail.item.attributes[1].value;
            that.details = e.detail.item.attributes[3].value;
            that.details = JSON.parse(that.details);
            that.details = that.details.tabs;
            console.log('details: ',that.details.tabs);
          });

        },

      openAddSubCat: function(){
        this.$.suboverlay.toggle();
      },

      fireDetail: function(){
        this.fire('toScene2');
      },


      toNext: function(){
        this.$.subcatscenes.selected = 0;
        this.fire('menureset');
      },

      toCatMenu: function(){
        this.$.subcatscenes.selected = 0;
        this.$.catselector.selected = '';
      },

      cattapped: function(){
        //if(window.innerWidth < 401){
          this.$.subcatscenes.selected = 1;
        //};
        },

        handleResponse: function(){
          console.log('ajax loaded', this.tabs, ' - ', this.subCat);
        }
      });

    })();
  </script>
</polymer-element>
