<link rel="import" href="../../bower_components/polymer/polymer.html">
<link rel="import" href="../../bower_components/core-ajax/core-ajax.html">


<polymer-element name="aos-profiel" attributes="yoyo">

  <template>
  <link rel="stylesheet" href="aos-profiel.css" />

  <template if="{{!$.globals.values.user}}">
  <div vertical layout center center-justified fit>
    <h1>Aanmelden</h1>
    user: {{responseUser}}
    <aos-globals id="globals"></aos-globals>
    <img src="{{responseUser.data.avatarUrl}}">
    <input value="{{username}}" placeholder="Je gebruikersnaam"></input>
    <input value="{{password}}" placeholder="Je wachtwoord" type="password"></input>
    <button on-tap="{{loginSubmit}}">Aanmelden</button>
  </div>
   <core-ajax method="GET" id="loginAjax" handleAs="json" url="/login" response="{{responseUser}}" on-core-response="{{handleResponseUser}}">
   </core-ajax>
   </template>
   <template if="{{$.globals.values.user}}" bind>
    <h1>{{$.globals.values.user.data.firstName}}</h1>
    <p>{{$.globals.values.userJSON}}</p>
    <button on-tap="{{logout}}">Logout</button>
    
   </template>

   <core-ajax method="GET" id="logoutAjax" handleAs="json" url="/logout" response="{{responseLogout}}" on-core-response="{{handleResponseLogout}}">

  </template>

  <script>



    Polymer({

      ready: function() {

      	console.log('profiel app loaded.');
        
        },

        logout: function(){
          this.$.logoutAjax.go();
          delete this.$.globals.values.user;
        },

        loginSubmit: function(){
          this.$.loginAjax.params = { "username": this.username, "password": this.password };
          //this.$.loginAjax.params = { "username": "kingflurkel", "password": "mike48" };
          this.$.loginAjax.go();
        },

        handleResponseUser: function(){
          this.$.globals.values.user = this.responseUser;
          this.$.globals.values.userJSON = JSON.stringify(this.$.globals.values.user.data);
        }

    });

  </script>

</polymer-element>
